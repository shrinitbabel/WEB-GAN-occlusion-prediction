# WEB-GAN-Occlusion-Prediction

A pipeline for generating synthetic clinical data using Conditional GANs (cGANs) and evaluating models for multi-class occlusion prediction following WEB embolization.

## Project Structure

### Notebooks
1. **`WEB_GAN.ipynb`**
    - Loads GAN-related modules.
    - Trains the Conditional GAN (cGAN).
    - Generates synthetic data.
    - Visualizes data distributions using Kernel Density Estimation (KDE).

2. **`multiclass_classification.ipynb`**
    - Runs multi-class classification using two model types: Random Forest (RF) and XGBoost (XGB).
    - Evaluates models in different configurations.
    - Analyzes performance metrics such as AUC.

3. **`model_agnostic_analysis.ipynb`**
    - Focuses on the two best-performing models (RF and XGB).
    - Performs post-hoc analysis, including:
      - Partial Dependence Plots (PDP).
      - Interaction effects.
      - Causal and counterfactual analysis with procedural variables.
      - WAVE ratio analysis.
      - Privacy analysis using Euclidean distance to records (distance-to-closest-record).

### Modules
Located in the `modules/` directory:
- **`__init__.py`**: Initializes the directory.
- **`gan.py`**: Implements the Conditional GAN (cGAN) architecture.
- **`gan_evaluation.py`**: Contains utilities for evaluating GAN performance.
- **`h_statistic.py`**: Computes the H-statistic for interaction effects.
- **`losses.py`**: Defines custom loss functions for GAN training.
- **`set_seed.py`**: Ensures reproducibility by setting random seeds.

### Data
- **`synthetic_data.csv`**: Synthetic data generated by the GAN.
- **Note**: Original data is available upon request.

## Usage
1. Start with `WEB_GAN.ipynb` to train the GAN and generate synthetic data.
2. Use `multiclass_classification.ipynb` to evaluate classification models on the generated data.
3. Perform advanced analysis with `model_agnostic_analysis.ipynb`.

### How to Reproduce
1. Clone the repository:
     ```bash
     git clone https://github.com/shrinitbabel/WEB-GAN-OCCLUSION-PREDICTION.git
     cd WEB-GAN-OCCLUSION-PREDICTION
     ```
2. Install the required dependencies:
     ```bash
     pip install -r requirements.txt
     ```
3. Train the GAN:
     ```bash
     jupyter notebook WEB_GAN.ipynb
     ```
4. Evaluate classification models:
     ```bash
     jupyter notebook multiclass_classification.ipynb
     ```
5. Perform model interpretability analysis:
     ```bash
     jupyter notebook model_agnostic_analysis.ipynb
     ```

## Requirements
- Python 3.8+
- Required libraries are listed in `requirements.txt` (if available).

## License
This project is licensed under the MIT License.
